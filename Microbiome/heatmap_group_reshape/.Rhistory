library(openxlsx)
library(pheatmap)
library(RColorBrewer)
library(ggplot2)
library(reshape2)
datadf <- read.xlsx("20190403_heatmap.xlsx", sheet = 2)
funcnames  = rownames(datadf)
meltdatadf = melt(datadf)
# meltdatadf$group = stringr::str_sub(meltdatadf$variable, 1, 1)
meltdatadf$group = stringr::str_extract(meltdatadf$variable, ".*_")
meltdatadf = meltdatadf[-2]
meltdatadf = aggregate(meltdatadf$value, by=list(func=meltdatadf$X1, time=meltdatadf$group), FUN=mean)
datadf = acast(meltdatadf, func ~ time)
savefilename = "20190403_heatmap.pdf"
pheatmap(as.matrix((datadf)),
filename = savefilename,
border_color = "white",
show_rownames = T,
show_colnames = T,
cluster_rows = F,
cluster_cols = F,
color = colorRampPalette(c("#AC2024", "white", "#89BC54"))(500)
)
colnames(datadf)
datadf = datadf[,c(1, 5, 8, 2, 3, 4, 6, 7)]
savefilename = "20190403_heatmap.pdf"
pheatmap(as.matrix((datadf)),
filename = savefilename,
border_color = "white",
show_rownames = T,
show_colnames = T,
cluster_rows = F,
cluster_cols = F,
color = colorRampPalette(c("#AC2024", "white", "#89BC54"))(500)
)
